"use strict";(self.webpackChunkcxr_mall_platform_webui=self.webpackChunkcxr_mall_platform_webui||[]).push([[5],{94622:function(e,n,t){t.d(n,{p:function(){return h}});var a=t(77117),r=t.n(a),l=t(28152),i=t.n(l),s=t(53178),o=t(42846),c=t(93236),u={search:{searchText:"查询",resetText:"重置",labelWidth:"auto",defaultCollapsed:!0},options:{setting:{listsHeight:400}},form:{syncToUrl:!1},pagination:{size:"default",showSizeChanger:!0,showQuickJumper:!0,defaultPageSize:20,hideOnSinglePage:!1,showTotal:function(e){return"共 ".concat(e," 条")}},dateFormatter:"string",tableAlertRender:!1},d=t(62086),p=function(e){var n=e.defaultHeight,t=e.scrollY;if(!t){var a,r=0,l=null===(a=e.ref.current)||void 0===a||null===(a=a.getElementsByClassName(e.elementsByClassName||"ant-table-body"))||void 0===a?void 0:a[0];l&&(r=l.getBoundingClientRect().top),e.searchRows&&r&&(r-=56*(e.searchRows-1));var i=Number(e.total)?64:0;n||(n=i+16),t="calc(100vh - ".concat(r+n,"px)")}return function(e,n){var t,a=null===(t=e.ref.current)||void 0===t?void 0:t.getElementsByClassName("ant-table-body")[0];if(a&&(a.style.display="block",a.style.height=n,a.style.overflow=Number(e.total)?"auto scroll":"hidden"),!Number(e.total)){var r,l=null===(r=e.ref.current)||void 0===r?void 0:r.getElementsByClassName("ant-table-placeholder")[0];l?(l.style.height=n,l.style.overflow="hidden"):a.style.display="flex"}}(e,t),t},h=function(e){var n=(0,c.useState)(),t=i()(n,2),a=t[0],l=t[1],h=(0,c.useRef)(null),f="boolean"!=typeof e.collapse||e.collapse,v=(0,c.useRef)(),m=(0,o.Z)(v),g=(0,c.useState)(0),x=i()(g,2),y=x[0],b=x[1],w={ref:h,scrollY:e.scrollY,searchRows:e.searchRows,elementsByClassName:e.elementsByClassName,defaultHeight:e.defaultHeight,total:y},j=function(n){var t,a;b(null!==(t=n.length)&&void 0!==t?t:0);var r=w;null!=n&&n.length&&(r.total=null==n?void 0:n.length),f&&l(p(r)),v.current=null===(a=h.current)||void 0===a?void 0:a.getElementsByClassName(e.elementsByClassName||"ant-table-thead")[0]};return(0,c.useEffect)((function(){f&&l(p(w))}),[]),(0,c.useEffect)((function(){e.dataSource&&e.dataSource.length>0&&j(e.dataSource)}),[null==e?void 0:e.dataSource]),(0,c.useEffect)((function(){l(p(w))}),[null==m?void 0:m.height]),(0,d.jsx)("div",{ref:h,children:(0,d.jsx)(s.Z,r()(r()(r()({},u),e),{},{scroll:{x:"100%",y:e.scrollY?e.scrollY:a,scrollToFirstRowOnChange:!0},tableStyle:e.defaultStyle?{height:"calc(100vh - 300px)"}:{},onLoad:j}))})}},47939:function(e,n,t){t.r(n),t.d(n,{default:function(){return D}});var a=t(77117),r=t.n(a),l=t(28152),i=t.n(l),s=t(69092),o=t(85966),c=t(93236),u=t(13448),d=t.n(u),p=t(74815),h=t.n(p),f=t(75784),v=t(63833),m=t(77709),g=t(62086),x=function(e){var n=m.Z.useForm(),t=i()(n,1)[0];return(0,g.jsxs)(f.t,{style:{padding:"24px 24px 8px 24px"},form:t,colon:!1,labelWidth:70,labelAlign:"left",autoFocusFirstInput:!1,onFinish:function(){var n=h()(d()().mark((function n(t){var a;return d()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",null===(a=e.onChange)||void 0===a?void 0:a.call(e,t));case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),onReset:function(){var n=h()(d()().mark((function n(t){var a;return d()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",null===(a=e.onChange)||void 0===a?void 0:a.call(e,t));case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),children:[(0,g.jsx)(v.Z,{name:"user_name",label:"用户名称",placeholder:"请输入用户名称"}),(0,g.jsx)(v.Z,{name:"phone",label:"手机号码",placeholder:"请输入手机号码"})]})},y=t(94622),b=t(53254),w="https://www.fastmock.site/mock/4f3ca3df8c126efba460bda14af61dc5/cxrApi",j=t(30909),S=t(22222),k=t(26633),Z=t(2639),N=j.Z.Paragraph,C=function(e){var n=e.params,t=(0,c.useRef)(),a=function(){var e=h()(d()().mark((function e(t){var a,l,s,o,c,u,p,h;return d()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.current,o=t.pageSize,e.next=3,(0,Z.Z)((d=r()(r()({},n),{page_num:s,page_size:o}),(0,b.request)("".concat(w,"/getUser"),{method:"POST",data:r()({},d)})));case 3:if(c=e.sent,u=i()(c,2),p=u[0],h=u[1],!p){e.next=9;break}return e.abrupt("return",{success:!1});case 9:return e.abrupt("return",{success:!0,data:(null===(a=h.data)||void 0===a?void 0:a.data)||[],total:null===(l=h.data)||void 0===l?void 0:l.count});case 10:case"end":return e.stop()}var d}),e)})));return function(n){return e.apply(this,arguments)}}(),l=[{title:"用户编号",dataIndex:"user_sn",width:220,render:function(e,n){return(0,g.jsx)(N,{className:"field-paragraph",style:{width:188},ellipsis:{rows:2,tooltip:n.user_sn},children:n.user_sn||"-"})}},{title:"用户名称",dataIndex:"user_name",render:function(e,n){return(0,g.jsx)(N,{className:"field-paragraph",style:{width:120},ellipsis:{rows:2,tooltip:n.user_name},children:n.user_name||"-"})}},{title:"公司",dataIndex:"company",render:function(e,n){return(0,g.jsx)(N,{className:"field-paragraph",style:{width:120},ellipsis:{rows:2,tooltip:n.company},children:n.company||"-"})}},{title:"部门",dataIndex:"dep",render:function(e,n){return(0,g.jsx)(N,{className:"field-paragraph",style:{width:120},ellipsis:{rows:2,tooltip:n.dep},children:n.dep||"-"})}},{title:"手机号码",dataIndex:"phone",render:function(e,n){return(0,g.jsx)(N,{className:"field-paragraph",style:{width:120},ellipsis:{rows:2,tooltip:n.phone},children:n.phone||"-"})}},{title:"操作",align:"right",fixed:"right",width:160,render:function(){return(0,g.jsxs)(S.Z,{size:18,children:[(0,g.jsx)(k.ZP,{type:"link",style:{padding:0},children:"编辑"}),(0,g.jsx)(k.ZP,{type:"link",style:{padding:0},children:"详情"}),(0,g.jsx)(k.ZP,{type:"link",style:{padding:0},children:"删除"})]})}}];return(0,g.jsx)(y.p,{actionRef:t,columns:l,request:a,params:n,headerTitle:(0,g.jsx)(k.ZP,{type:"primary",children:"新增"},"primary"),rowKey:"id",search:!1,defaultHeight:90})},_="UserTree___ayeT2",E="TreeNode___p2vcZ",R=t(21897),B=t(34087),P=t(44208),T=t(16450),I={fieldNames:{key:"id",title:"name",children:"children"},selectable:!0,showIcon:!0},z=t(99938),F=t(66292),H=t.n(F),O=t(33198),Y=t(40714),q=t(93915),A=t(85303);var K=function(e,n){var t;A.Z&&(0,q.mf)(e);var a=(0,O.Z)(e),r=null!==(t=null==n?void 0:n.wait)&&void 0!==t?t:1e3,l=(0,c.useMemo)((function(){return H()((function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return a.current.apply(a,(0,z.ev)([],(0,z.CR)(e),!1))}),r,n)}),[]);return(0,Y.Z)((function(){l.cancel()})),{run:l,cancel:l.cancel,flush:l.flush}};var M=function(e,n){var t=(0,z.CR)((0,c.useState)(e),2),a=t[0],r=t[1],l=K((function(){r(e)}),n).run;return(0,c.useEffect)((function(){l()}),[e]),a},U=B.Z.Search,W=function(e){var n=e.onChange,t=(0,c.useState)([]),a=i()(t,2),l=a[0],s=a[1],o=(0,c.useState)([]),u=i()(o,2),p=u[0],f=u[1],v=(0,c.useState)([]),m=i()(v,2),x=m[0],y=m[1],j=(0,c.useState)(""),S=i()(j,2),N=S[0],C=S[1],B=M(N,{wait:200}),z=function(){var e=h()(d()().mark((function e(){var t,a,l,o,c;return d()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,Z.Z)((u=void 0,(0,b.request)("".concat(w,"/getTree"),{method:"POST",data:r()({},u)})));case 2:if(t=e.sent,a=i()(t,2),l=a[0],o=a[1],!l){e.next=8;break}throw l;case 8:o.data&&(c=[],o.data.forEach((function(e,t){c.push(e.id),0===t&&(y([e.id]),n(e))})),f(c),s(o.data));case 9:case"end":return e.stop()}var u}),e)})));return function(){return e.apply(this,arguments)}}();(0,c.useEffect)((function(){z()}),[]);var F=(0,c.useMemo)((function(){return function(e,n){return function e(t){return null==t?void 0:t.map((function(t){var a,l=0===t.parentId?(0,g.jsx)("i",{className:"iconfont icon-enterprise-solid"}):(0,g.jsx)("i",{className:"iconfont icon-folder"}),i=t.name,s=i.indexOf(n),o=i.substring(0,s),c=i.slice(s+n.length),u=s>-1?(0,g.jsxs)("span",{children:[o,(0,g.jsx)("span",{className:"color-base",children:n}),c]}):(0,g.jsx)("span",{children:i}),d=s>-1||null!==(a=t.children)&&void 0!==a&&a.length?i:null;return r()(r()({},t),{icon:l,name:u,isHas:d,children:e(t.children)})}))}(e)}(l,B)}),[l,B]);return(0,g.jsxs)(P.Z,{vertical:!0,gap:16,className:_,children:[(0,g.jsxs)(P.Z,{justify:"space-between",children:[(0,g.jsx)(P.Z,{flex:1,children:(0,g.jsx)(U,{placeholder:"请输入部门名称",onSearch:function(e){var n;C(null!==(n=null==e?void 0:e.trim())&&void 0!==n?n:"")}})}),(0,g.jsx)(k.ZP,{type:"link",icon:(0,g.jsx)(R.Z,{}),children:"新增"})]}),(0,g.jsx)(T.Z,r()(r()({},I),{},{className:E,selectedKeys:x,onSelect:function(e,t){var a;if(null!==(a=t.node.children)&&void 0!==a&&a.length)p.includes(t.node.id)?f(p.filter((function(e){return e!==t.node.id}))):f(p.concat(t.node.id));else{for(var r,l=t.nativeEvent.target;l;){var i,s;if(null!==(i=l)&&void 0!==i&&null!==(i=i.className)&&void 0!==i&&i.includes("ant-tree-node-content-wrapper")&&null!==(s=l.previousElementSibling)&&void 0!==s&&null!==(s=s.className)&&void 0!==s&&s.includes("ant-tree-checkbox"))break;l=l.parentElement}if(l)null===(r=l.previousElementSibling)||void 0===r||r.dispatchEvent(new MouseEvent("click",{cancelable:!1,bubbles:!0}))}y([t.node.id]),n({id:t.node.id,key:t.node.key,name:t.node.name})},onExpand:function(e){f(e)},treeData:F,expandedKeys:p,blockNode:!0}))]})},D=function(){var e=(0,c.useState)(),n=i()(e,2),t=n[0],a=n[1],l={page_num:1,page_size:20},u=(0,c.useState)(l),d=i()(u,2),p=d[0],h=d[1];return(0,g.jsx)(s._z,{token:{paddingInlinePageContainerContent:16,paddingBlockPageContainerContent:12},header:{ghost:!0,title:!1,breadcrumb:{items:[{title:"用户管理"}]}},children:(0,g.jsxs)(o.Z,{gutter:16,ghost:!0,children:[(0,g.jsx)(o.Z,{colSpan:"360px",bodyStyle:{height:"calc( 100vh - 126px )",paddingInline:"26px 8px",paddingBlock:24},children:(0,g.jsx)(W,{onChange:a})}),(0,g.jsxs)(o.Z,{colSpan:"auto",bodyStyle:{height:"calc( 100vh - 184px )",padding:0},title:null==t?void 0:t.name,headerBordered:!0,children:[(0,g.jsx)(x,{params:p,onChange:function(e){h(r()(r()({},e),l))}}),(0,g.jsx)(C,{params:p})]})]})})}}}]);